"use strict";(function(){function t(t){return"textarea"===t.target.tagName.toLowerCase()}function e(t){return new n(t)}function n(e){var n=this,a={};this.container=e.container,this.inner=e.inner,this.content=e.content,this.isReset="false"!=e.reset,this.wheelValue=e.value?e.value:20,this.type=e.type&&""!==e.type?e.type:"vertical",this.wheelData=0,this.data={},this.createControl=function(){this.handleContainer=$ts.ce({tag:"div",class:"scroll_handleContainer "+this.type,parent:this.container}),this.bar=$ts.ce({tag:"div",class:"scroll_bar",parent:this.handleContainer}),this.handler=$ts.ce({tag:"div",class:"scroll_handler",parent:this.handleContainer}),this.addEvent();var t=setInterval(function(){n.container.offsetHeight&&(clearInterval(t),n.getData())},10)},this.wheel=function(e){if(!t(e)){var n,i,a=this.wheelValue;e.deltaY?(n=-e.deltaY/120,window.opera&&(n=-n)):e.detail&&(n=-e.detail/3),this.wheelData=n<0?this.wheelData>-a?this.wheelData+n:-a:this.wheelData<0?this.wheelData+n:0,i=-this.wheelData/a,this.getData(),this.movePage(i),this.moveHandler(i)}},this.getData=function(){a.containerHeight=this.container.offsetHeight,a.containerWidth=this.container.offsetWidth,a.contentHeight=this.content.offsetHeight,a.contentWidth=this.content.offsetWidth,a.maxHeight=a.containerHeight-a.contentHeight,a.maxWidth=a.containerWidth-a.contentWidth,a.handler={width:this.handler.offsetWidth,height:this.handler.offsetHeight},a.barSize="vertical"===this.type?this.bar.offsetHeight-a.handler.height:this.bar.offsetWidth-a.handler.width,this.data=a},this.addEvent=function(){this.handlerEvent=new i({container:this.container,dragObj:this.handler,type:this.type,callBack:{start:function(t){n.getData()},move:function(t){n.moveHandler(n.getRate("handler")),n.movePage(n.getRate("handler"))},end:function(t){}}}),this.bar.addEventListener("click",this.clickBar.bind(this)),"touch"===this.content.getAttribute("data-scroll-content")&&(this.contentEvent=new i({container:this.container,dragObj:this.content,type:this.type,callBack:{move:function(t){var e=n.content.offsetTop,i=n.content.offsetLeft;e>0?e/=3:e<n.data.maxHeight&&(e=n.data.maxHeight+(e-n.data.maxHeight)/3),i>0?i/=3:i<n.data.maxWidth&&(i=n.data.maxWidth+(i-n.data.maxWidth)/3),"horizon"!==n.type&&(n.content.style.top=e+"px"),"vertical"!==n.type&&(n.content.style.left=i+"px"),n.moveHandler(n.getRate("content"))},end:function(t){n.moveHandler(n.getRate("content")),n.movePage(n.getRate("content"))}}})),"vertical"===this.type&&this.container.addEventListener("wheel",this.wheel.bind(this))},this.clickBar=function(t){this.getData();var e="touchmove"==t.type?t.touches[0].clientY:t.clientY,n="touchmove"==t.type?t.touches[0].clientX:t.clientX,i=this.bar.getBoundingClientRect().top,a=this.bar.getBoundingClientRect().left,h={width:this.bar.getBoundingClientRect().width,height:this.bar.getBoundingClientRect().height},o="vertical"===this.type?e-i:n-a,s="vertical"===this.type?o/h.height:o/h.width;this.moveHandler(s),this.movePage(s)},this.getRate=function(t){var e;return e="handler"===t?"vertical"===this.type?this.handler.offsetTop/this.data.barSize:this.handler.offsetLeft/this.data.barSize:"vertical"===this.type?this.content.offsetTop/this.data.maxHeight:this.content.offsetLeft/this.data.maxWidth,e},this.moveHandler=function(t){var e=t<0?0:t>=1?1:t,n=this.data.barSize*e;"horizon"!==this.type&&(this.handler.style.top=n+"px"),"vertical"!==this.type&&(this.handler.style.left=n+"px")},this.movePage=function(t){var e=t<0?0:t>=1?1:t,n="vertical"===this.type?this.data.maxHeight*e:this.data.maxWidth*e;n>0&&(n=-n),"horizon"!==this.type&&(this.content.style.top=n+"px"),"vertical"!==this.type&&(this.content.style.left=n+"px")},this.reset=function(){this.getData(),this.moveHandler(0),this.movePage(0)},this.set=function(){this.createControl()},this.set()}function i(e){function n(){s.addEventListener("click",a,!0)}function i(){s.removeEventListener("click",a,!0)}function a(){arguments[0].stopPropagation()}var h=this,o=e.type?e.type:"all",s=e.dragObj,c=(e.dropObj?e.dropObj:document,e.container?e.container:document),r=e.callBack&&e.callBack.start?e.callBack.start:null,l=e.callBack&&e.callBack.move?e.callBack.move:null,d=e.callBack&&e.callBack.end?e.callBack.end:null;this.startDrag=function(e){function a(t){var e="touchmove"==t.type?t.touches[0].clientY:t.clientY,n="touchmove"==t.type?t.touches[0].clientX:t.clientX,i=(e-f)/u+p,a=(n-g)/u+m;h.newY=i,h.newX=a,"horizon"!==o&&(s.style.top=i+"px"),"vertical"!==o&&(s.style.left=a+"px"),l&&l(h)}function v(){var t,e,o,s;t=arguments[0],e=t.clientX||t.changedTouches[0].clientX,o=t.clientY||t.changedTouches[0].clientY,s=Math.abs(g-e)<10&&Math.abs(f-o)<10,s&&(i(),window.setTimeout(n)),c.removeEventListener("mousemove",a),c.removeEventListener("touchmove",a),document.removeEventListener("mouseup",v),document.removeEventListener("touchend",v),d&&d(h)}if(r&&r(h),!t(e)){var u=$pm.zoomRate?$pm.zoomRate:1,f="touchstart"==e.type?e.touches[0].clientY:e.clientY,g="touchstart"==e.type?e.touches[0].clientX:e.clientX,p=s.offsetTop,m=s.offsetLeft;s.style.transition="none",c.addEventListener("mousemove",a),c.addEventListener("touchmove",a),document.addEventListener("mouseup",v),document.addEventListener("touchend",v)}},s.addEventListener("mousedown",this.startDrag.bind(this)),s.addEventListener("touchstart",this.startDrag.bind(this)),c.addEventListener("touchstart",function(t){t.stopPropagation()}),n()}window.$scroll=e})();