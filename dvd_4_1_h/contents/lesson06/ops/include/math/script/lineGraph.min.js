"use strict";function _classCallCheck(t,e){if(!_instanceof(t,e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),t}function _instanceof(t,e){return null!=e&&"undefined"!=typeof Symbol&&e[Symbol.hasInstance]?!!e[Symbol.hasInstance](t):t instanceof e}(function(){function t(t,e){for(var i=[],n=e||document,s=n.querySelectorAll(t),o=0;o<s.length;o++)i.push(s[o]);return i.length>1?i:i[0]}function e(t,e){var i=t.getAttribute(e);return i.indexOf(",")>-1&&(i=i.replace(" ","").split(",")),_instanceof(i,Array)?i:[i]}function i(t){var e=t.offsetWidth,i=t.getBoundingClientRect().width;return i/e}var n=".js-drawArea",s=".js-dot",o="data-type",r="data-index",a=function(){function t(i){_classCallCheck(this,t),this.dom=i,this.type=e(this.dom,o),this.index=e(this.dom,r),this.on=this.on.bind(this),this.normalize=this.normalize.bind(this)}return _createClass(t,[{key:"on",value:function(){this.dom.classList.remove(CLASS_COMPLETE),this.dom.classList.add(CLASS_ON),this.dom.style.pointerEvents="none"}},{key:"normalize",value:function(){this.isComplete=!1,this.dom.classList.remove(CLASS_COMPLETE),this.dom.classList.remove(CLASS_ON),this.dom.style.pointerEvents=""}},{key:"style",get:function(){return{width:this.dom.offsetWidth,height:this.dom.offsetHeight,x:this.dom.offsetLeft,y:this.dom.offsetTop,centerX:this.dom.offsetWidth/2,centerY:this.dom.offsetHeight/2}}}]),t}(),l=function(){function e(n){var o=this;_classCallCheck(this,e),this.OPTS=n,this.container=n.container,this.zoomRate=i(this.container),this.style=this.setStyle(n),this.drawArea=this.setDrawArea(),this.resetButton=n.resetButton,this.dots=t(s,this.container).map(function(t){var e=new a(t);return t.addEventListener("click",o.clickedDot.bind(o,e)),$efSound&&$efSound.click&&t.addEventListener("click",$efSound.click),e}),this.callback=n.callback,this.length=n.length||5,this.lineArray=new Array(this.length),this.resetButton&&(this.resetButton.addEventListener("mouseover",function(){o.resetButton.classList.add("hover")}),this.resetButton.addEventListener("mouseout",function(t){o.resetButton.classList.remove("hover")}),this.resetButton.addEventListener("click",this.reset.bind(this)),$efSound&&$efSound.click&&this.resetButton.addEventListener("click",$efSound.click))}return _createClass(e,[{key:"getIsCallback",value:function(t){return this.callback&&this.callback[t]}},{key:"clickedDot",value:function(t){var e=t.type;this.lineArray[e]={x:t.style.x+t.style.centerX,y:t.style.y+t.style.centerY},this.clearCanvas(),this.draw(),this.getIsCallback("click")&&this.callback.click(this,t)}},{key:"draw",value:function(){var t=this,e=function(e,i){e&&t.context.lineTo(e.x,e.y)};this.context.beginPath(),this.lineArray.forEach(e),this.context.stroke(),this.context.restore(),this.context.save()}},{key:"reset",value:function(){this.zoomRate=i(this.container),this.setDrawArea(),this.lineArray=new Array(this.length),this.clearCanvas(),this.getIsCallback("reset")&&this.callback.reset(this)}},{key:"clearCanvas",value:function(){this.context.clearRect(0,0,this.drawArea.width,this.drawArea.height)}},{key:"setDrawArea",value:function(){var e=t(n,this.container);return e.width=this.container.offsetWidth,e.height=this.container.offsetHeight,this.context=e.getContext("2d"),this.context&&(this.context.strokeStyle=this.style.lineColor,this.context.fillStyle=this.style.fillStyle,this.context.lineWidth=this.style.lineWidth,this.context.lineCap=this.style.lineCap,this.context.lineJoin=this.style.lineJoin,this.context.save()),e}},{key:"setStyle",value:function(t){return{lineColor:t.lineColor||"tomato",fillStyle:t.fillStyle||"tomato",lineWidth:t.lineWidth||6,lineCap:t.lineCap||"round",lineJoin:t.lineJoin||"round"}}}]),e}();window.$LineGraph=l})();